# 生成AI主導 開発ワークフロー案

## 0. 前提
- GitHubを**唯一の情報ハブ**とする（仕様・タスク・議事録・エージェント運用・CI/CD）。
- メイン開発エージェントは **ClaudeCode**、サブが **Codex**。
- 成果物の中心は**スペック**であり、コードは再生成可能であることを前提にする。
- 開発/テスト環境はVPS（人間の開発者ごとに割当）。

---

## 1. リポジトリ設計（最小限で衝突を減らす）
### 1-1. 情報の「唯一の参照点」を定義
- **仕様の唯一のソース**: `specs/`
- **タスクの唯一のソース**: `tasks/`
- **エージェント運用の唯一のソース**: `agents/`
- **MVP後の並列開発**は上記をベースに行う。

### 1-2. 仕様のバージョニング
- 仕様は1つのまとまった「Specファイル」とし、PRでレビュー。
- 仕様の変更は必ず「差分」と「理由」を記載。

---

## 2. ワークフロー全体像
### Phase A: 仕様策定（Spec First）
1. `templates/spec-template.md` を複製
2. `specs/` に新規Specを追加
3. PRにてレビューし承認

### Phase B: MVP作成（ClaudeCode単独）
1. ClaudeCodeが `specs/` から設計・実装
2. 仕様 → タスク分解（`tasks/`） → TDDで実装
3. MVPをGitHubへpush

### Phase C: 並列開発開始
1. Codexを含む複数エージェントで並列タスク実行
2. 衝突回避: **1タスク = 1PR**
3. 仕様に影響する変更は先にSpec PRを出す

---

## 3. コンフリクト/不整合対策（最小限）
### 3-1. 仕様と実装の一貫性
- **Spec変更が先**、実装は後。
- `specs/` 以外で仕様を書くことは禁止。

### 3-2. タスクの粒度とルール
- `tasks/` に「実装単位のタスク」を定義
- **タスク1つにつき1ブランチ/1PR**

### 3-3. エージェントファイル共有
- `agents/` にClaude/Codex運用ガイドを置き、変更はPR運用
- 変更内容を `docs/CHANGELOG.md` に記録

---

## 4. TDD & 自己改善ループ
### 4-1. VPS環境
- 各開発者にVPSを割当
- `scripts/setup_vps.sh` で共通セットアップ

### 4-2. TDDルール
- 仕様→テスト→実装 の順で進行
- `tests/` の増加は必ずSpecに紐づける

### 4-3. 自己改善
- エージェントがテスト失敗時に原因分析 → Spec更新 → 再テスト

---

## 5. GitHub運用
### 5-1. PRルール
- PRは**Spec/Task/Code**のいずれかに分類
- PRテンプレートに「Specリンク」「テスト結果」を必須

### 5-2. CI/CD
- GitHub Actionsで最低限のテストを実行
- VPS環境でE2E/統合テスト

---

## 6. 軽量でスピード感を出すための原則
- **Spec > Code** を徹底
- PRは小さく、1タスク1PR
- テンプレートを活用し、レビューを高速化

---

## 7. 次のアクション
1. `specs/` に最初のSpecを追加
2. ClaudeCodeでMVPを作成
3. MVP完了後に並列開発へ移行

